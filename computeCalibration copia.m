function [K] = computeCalibration(homo1,homo2)

u= homo1(:,1);
v= homo1(:,2);
s= homo2(:,1);
t= homo2(:,2);

% constraint 1
A= zeros(6,6);
A(1,1)= u(1)*v(1); 
A(1,2)= u(1)*v(2)+u(2)*v(1);
A(1,3)= u(2)*v(2);
A(1,4)= u(1)*v(3)+u(3)*v(1);
A(1,5)= u(2)*v(3)+u(3)*v(2);
A(1,6)= u(3)*v(3);
% constraint 2
A(2,1)= s(1)*t(1); 
A(2,2)= s(1)*t(2)+s(2)*t(1);
A(2,3)= s(2)*t(2);
A(2,4)= s(1)*t(3)+s(3)*t(1);
A(2,5)= s(2)*t(3)+s(3)*t(2);
A(2,6)= s(3)*t(3);
% constraint 3
A(3,1)= u(1)^2-v(1)^2; 
A(3,2)= 2*u(1)*u(2)-2*v(2)*v(1);
A(3,3)= u(2)^2-v(2)^2;
A(3,4)= 2*u(1)*u(3)-2*v(3)*v(1);
A(3,5)= 2*u(2)*u(3)-2*v(3)*v(2);
A(3,6)= u(3)^2-v(3)^2;
% constraint 4
A(4,1)= s(1)^2-t(1)^2; 
A(4,2)= 2*s(1)*s(2)-2*t(2)*t(1);
A(4,3)= s(2)^2-t(2)^2;
A(4,4)= 2*s(1)*s(3)-2*t(3)*t(1);
A(4,5)= 2*s(2)*s(3)-2*t(3)*t(2);
A(4,6)= s(3)^2-t(3)^2;
% constraint 5
A(5,2)= 1;
% constraint 6
A(6,1)= 1;
A(6,3)= -1;

[U,S,V] = svd(A);
W = V(:,6);
w= [W(1),W(2),W(4);W(2),W(3),W(5);W(4),W(5),W(6)];
winv= inv(w);
K = chol(winv,'lower');

end